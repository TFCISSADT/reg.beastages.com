(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{528:function(e,t,r){"use strict";r.r(t);var n={},o=r(21),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex mr:8>*"},[e.params.data.ticket_order_status<90?t("Button",{attrs:{type:"primary"},on:{click:function(t){return e.params.editHandler(e.params)}}},[e._v(e._s(e.$t("common.edit")))]):e._e(),e._v(" "),e.params.data.ticket_order_status<90?t("Dropdown",{attrs:{type:"secondary",text:e.$t("admin.attendees.buttons.mail")}},[t("Button",{attrs:{type:"secondary"},on:{click:function(t){return e.params.resendPaidMailHandler(e.params)}}},[e._v(e._s(e.$t("admin.ticketOrders.buttons.resendTickets")))])],1):e._e(),e._v(" "),e.params.data.ticket_order_status<90?t("Button",{attrs:{type:"negative"},on:{click:function(t){return e.params.deleteHandler(e.params)}}},[e._v(e._s(e.$t("common.delete")))]):e._e(),e._v(" "),t("Dropdown",{attrs:{type:"secondary"}},[e.params.data.ticket_order_status<7?t("Button",{attrs:{type:"secondary"},on:{click:function(t){return e.params.changeTicketOrderToPaidHandler(e.params)}}},[e._v(e._s(e.$t("admin.attendees.buttons.changeAttendeeToPaid")))]):e._e(),e._v(" "),"99"==e.params.data.ticket_order_status?t("Button",{attrs:{type:"secondary"},on:{click:function(t){return e.params.restoreHandler(e.params)}}},[e._v(e._s(e.$t("admin.attendees.buttons.restoreAttendee")))]):e._e(),e._v(" "),"10"==e.params.data.ticket_order_status?t("Button",{attrs:{type:"secondary"},on:{click:function(t){return e.params.refundHandler(e.params)}}},[e._v(e._s(e.$t("admin.attendees.buttons.refund")))]):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Button:r(370).default,Dropdown:r(386).default})},568:function(e,t,r){"use strict";r.r(t);var n=r(3),o=(r(20),r(68)),d=r(54),c=r.n(d),l=r(528),m=r(392),_=r.n(m),f=r(418),k=r.n(f),h=r(458),w=r.n(h),v={layout:"admin",components:{TicketOrderButtonsCellRenderer:l.default},watch:{showAll:function(){this.getTicketOrders()},showManualIntervention:function(e){e?this.gridAPI.getFilterInstance("ticket_order_status").setModel({filterType:"text",type:"equals",filter:this.$t("ticket_order_status.3")}):this.gridAPI.getFilterInstance("ticket_order_status").setModel({filterType:"text",type:"equals",filter:null}),this.gridAPI.onFilterChanged()}},data:function(){var e=this;return{COUNTRIES:_.a,SHIRT_SIZES:k.a,RECEIVE_METHODS:w.a,loading:!1,columnDefs:[{field:"buttons",headerName:" ",cellRenderer:"TicketOrderButtonsCellRenderer",cellRendererParams:{resendPaidMailHandler:this.resendPaidMailHandler,editHandler:this.editHandler,deleteHandler:this.deleteHandler,changeTicketOrderToPaidHandler:this.changeTicketOrderToPaidHandler,refundHandler:this.refundHandler,restoreHandler:this.restoreHandler},width:384,sortable:!1,filter:!1},{field:"ticket_order_id",headerName:this.$t("admin.ticketOrders.fields.ticket_order_id"),width:128,tooltipField:"ticket_order_id"},{field:"ticket_type",headerName:this.$t("admin.tickets.fields.ticket_type"),width:128,tooltipField:"ticket_type",valueGetter:function(t){return e.$t("admin.tickets.types."+t.data.ticket_type)},filterValueGetter:function(t){return e.$t("admin.tickets.types."+t.data.ticket_type)}},{field:"ticket_order_status",headerName:this.$t("admin.ticketOrders.fields.ticket_order_status"),width:128,tooltipField:"ticket_order_status",valueGetter:function(t){return e.$t("ticket_order_status."+t.data.ticket_order_status)},filterValueGetter:function(t){return e.$t("ticket_order_status."+t.data.ticket_order_status)}},{field:"ticket_order_email",headerName:this.$t("admin.ticketOrders.fields.ticket_order_email"),width:128,tooltipField:"ticket_order_email"},{field:"ticket_order_code",headerName:this.$t("admin.ticketOrders.fields.ticket_order_code"),width:128,tooltipField:"ticket_order_code"},{field:"ticket_order_quantity",headerName:this.$t("admin.ticketOrders.fields.ticket_order_quantity"),width:128,tooltipField:"ticket_order_quantity"},{field:"ticket_order_total_amount",headerName:this.$t("admin.ticketOrders.fields.ticket_order_total_amount"),width:128,tooltipField:"ticket_order_total_amount"},{field:"ticket_order_payment_method",headerName:this.$t("admin.attendees.fields.attendee_payment_method"),width:128,tooltipField:"ticket_order_payment_method"},{field:"order_token",headerName:this.$t("admin.attendees.fields.order_token"),width:128,tooltipField:"order_token"},{field:"remarks",headerName:this.$t("admin.attendees.fields.remarks"),minWwidth:128,tooltipField:"remarks"},{field:"created_at",headerName:this.$t("admin.attendees.fields.created_at"),width:224,tooltipField:"created_at",valueGetter:function(e){return new Date(e.data.created_at).toLocaleString("zh-TW")},filterValueGetter:function(e){return new Date(e.data.created_at).toLocaleString("zh-TW")}},{field:"updated_at",headerName:this.$t("admin.attendees.fields.updated_at"),width:224,tooltipField:"updated_at",valueGetter:function(e){return new Date(e.data.updated_at).toLocaleString("zh-TW")},filterValueGetter:function(e){return new Date(e.data.updated_at).toLocaleString("zh-TW")}},{field:"created_by",headerName:this.$t("admin.attendees.fields.created_by"),width:128,tooltipField:"created_by"},{field:"updated_by",headerName:this.$t("admin.attendees.fields.updated_by"),width:128,tooltipField:"updated_by"}],defaultColumnDef:{sortable:!0,filter:!0,floatingFilter:!0,resizable:!0,floatingFilterComponentParams:{suppressFilterButton:!0}},gridAPI:null,gridColumnAPI:null,config:c.a.getConfig(),showAll:!1,showManualIntervention:!1,ticketOrders:[],modal:{show:!1,mode:"edit",errorFields:{},form:{ticket_order_id:null,ticket_order_email:null,ticket_order_code:null,remarks:null}},deleteDialog:{show:!1,ticketOrderID:null},refundDialog:{show:!1,ticketOrderID:null}}},mounted:function(){this.getTicketOrders()},methods:{getTicketOrders:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$axios.get("/api/admin/ticketOrders"+(e.showAll?"?all=yes":"")).then((function(t){e.ticketOrders=t.data.ticketOrders})).catch((function(e){o.a.showRequestError(e)}));case 3:e.loading=!1;case 4:case"end":return t.stop()}}),t)})))()},editHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.modal.mode="edit",t.modal.form.ticket_order_id=e.data.ticket_order_id,t.modal.form.ticket_order_code=e.data.ticket_order_code,t.modal.form.ticket_order_email=e.data.ticket_order_email,t.modal.form.remarks=e.data.remarks,t.$set(t.modal,"errorFields",{}),t.modal.show=!0;case 7:case"end":return r.stop()}}),r)})))()},editTicketOrder:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$axios.put("/api/admin/ticketOrder/"+e.modal.form.ticket_order_id,e.modal.form).then((function(t){o.a.showSnackbar({message:e.$t("common.messages.updateSucceed"),colorType:"positive"}),e.modal.show=!1,e.getTicketOrders()})).catch((function(t){t.response&&"422"==t.response.status&&e.$set(e.modal,"errorFields",t.response.data.errors),o.a.showRequestError(t)}));case 3:e.loading=!1;case 4:case"end":return t.stop()}}),t)})))()},deleteHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.deleteDialog.ticketOrderID=e.data.ticket_order_id,t.deleteDialog.show=!0;case 2:case"end":return r.stop()}}),r)})))()},deleteTicketOrder:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.delete("/api/admin/ticketOrder/"+t.deleteDialog.ticketOrderID).then((function(e){o.a.showSnackbar({message:t.$t("common.messages.deleteSucceed"),colorType:"positive"}),t.getTicketOrders()})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1,t.deleteDialog.show=!1;case 5:case"end":return e.stop()}}),e)})))()},resendPaidMailHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$axios.post("/api/admin/ticketOrder/"+e.data.ticket_order_id+"/mail/paid").then((function(e){o.a.showSnackbar({message:t.$t("admin.attendees.messages.resend_paid_mail_succeed"),colorType:"positive"})})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()},assignEntranceTokenHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$axios.post("/api/admin/ticketOrder/"+e.data.ticket_order_id+"/assignEntranceToken").then((function(e){o.a.showSnackbar({message:t.$t("admin.attendees.messages.assign_access_token_succeed"),colorType:"positive"}),t.getTicketOrders()})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()},changeTicketOrderToPaidHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$axios.post("/api/admin/ticketOrder/"+e.data.ticket_order_id+"/payment/paid").then((function(e){o.a.showSnackbar({message:t.$t("admin.attendees.messages.change_attendee_to_paid_succeed"),colorType:"positive"}),t.getTicketOrders()})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()},restoreHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$axios.post("/api/admin/ticketOrder/"+e.data.ticket_order_id+"/restore").then((function(e){o.a.showSnackbar({message:t.$t("admin.attendees.messages.restore_attendee_succeed"),colorType:"positive"}),t.getTicketOrders()})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()},refundHandler:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.refundDialog.ticketOrderID=e.data.ticket_order_id,t.refundDialog.show=!0;case 2:case"end":return r.stop()}}),r)})))()},refundTicketOrder:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.post("/api/admin/ticketOrder/"+t.refundDialog.ticketOrderID+"/payment/refund").then((function(e){o.a.showSnackbar({message:t.$t("admin.attendees.messages.refund_attendee_succeed"),colorType:"positive"}),t.getTicketOrders()})).catch((function(e){o.a.showRequestError(e)}));case 3:t.loading=!1,t.refundDialog.show=!1;case 5:case"end":return e.stop()}}),e)})))()},onGridReady:function(e){this.gridAPI=e.api,this.gridColumnAPI=e.columnApi}}},y=r(21),component=Object(y.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex flex-direction:column h:100%"},[t("Loading",{attrs:{value:e.loading}}),e._v(" "),t("div",{staticClass:"flex"},[t("Button",{staticClass:"width:100%",on:{click:function(t){return e.showAll=!e.showAll}}},[e._v(e._s(e.$t("admin.buttons.showAll"))+" :\n      "+e._s(e.$t("common."+(e.showAll?"yes":"no")))+"\n    ")]),e._v(" "),t("Button",{staticClass:"width:100%",on:{click:function(t){return e.showManualIntervention=!e.showManualIntervention}}},[e._v(e._s(e.$t("admin.buttons.showManualIntervention"))+" :\n      "+e._s(e.$t("common."+(e.showManualIntervention?"yes":"no")))+"\n    ")]),e._v(" "),t("Button",{staticClass:"width:100%",on:{click:function(t){e.gridAPI&&e.gridAPI.exportDataAsCsv()}}},[e._v(e._s(e.$t("admin.buttons.downloadCSV"))+"\n    ")])],1),e._v(" "),t("ag-grid-vue",{staticClass:"ag-theme-alpine",staticStyle:{"flex-grow":"1"},attrs:{columnDefs:e.columnDefs,defaultColDef:e.defaultColumnDef,rowData:e.ticketOrders,enableCellTextSelection:!0,suppressRowTransform:!0,animateRows:"true"},on:{"grid-ready":e.onGridReady}}),e._v(" "),t("Modal",{attrs:{value:e.modal.show}},[t("div",{staticClass:"round border drop-shadow p:16|32 bg:white"},[t("h2",[e._v("\n        "+e._s(e.$t("common."+e.modal.mode))+e._s(e.$t("admin.attendees.itemName"))+"\n      ")]),e._v(" "),t("Field",{attrs:{field:e.$t("admin.ticketOrders.fields.ticket_order_email"),error:e.modal.errorFields.ticket_order_email}},[t("InputText",{attrs:{error:e.modal.errorFields.ticket_order_email,maxlength:64},model:{value:e.modal.form.ticket_order_email,callback:function(t){e.$set(e.modal.form,"ticket_order_email",t)},expression:"modal.form.ticket_order_email"}})],1),e._v(" "),t("Field",{attrs:{field:e.$t("admin.ticketOrders.fields.ticket_order_code"),error:e.modal.errorFields.ticket_order_code}},[t("InputText",{attrs:{error:e.modal.errorFields.ticket_order_code,maxlength:64},model:{value:e.modal.form.ticket_order_code,callback:function(t){e.$set(e.modal.form,"ticket_order_code",t)},expression:"modal.form.ticket_order_code"}})],1),e._v(" "),t("Field",{attrs:{field:e.$t("admin.attendees.fields.remarks"),error:e.modal.errorFields.remarks}},[t("InputText",{attrs:{error:e.modal.errorFields.remarks},model:{value:e.modal.form.remarks,callback:function(t){e.$set(e.modal.form,"remarks",t)},expression:"modal.form.remarks"}})],1),e._v(" "),t("div",{staticClass:"flex"},[t("Button",{staticClass:"mr:8",attrs:{type:"negative"},on:{click:function(t){return e.modal.show=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),t("Button",{on:{click:e.editTicketOrder}},[e._v(e._s(e.$t("common.submit")))])],1)],1)]),e._v(" "),t("Dialog",{attrs:{value:e.deleteDialog.show,yesText:e.$t("common.delete"),yesType:"negative",noText:e.$t("common.cancel"),noType:"secondary",title:e.$t("common.messages.confirmDeleteTitle"),description:e.$t("common.messages.confirmDeleteDescription")},on:{yes:e.deleteTicketOrder,no:function(t){return e.deleteDialog.show=!1}}}),e._v(" "),t("Dialog",{attrs:{value:e.refundDialog.show,yesText:e.$t("common.delete"),yesType:"negative",noText:e.$t("common.cancel"),noType:"secondary",title:e.$t("admin.attendees.messages.confirm_refund_title"),description:e.$t("admin.attendees.messages.confirm_refund_description")},on:{yes:e.refundTicketOrder,no:function(t){return e.refundDialog.show=!1}}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Loading:r(136).default,Button:r(370).default,InputText:r(372).default,Field:r(374).default,Modal:r(399).default,Dialog:r(405).default})}}]);