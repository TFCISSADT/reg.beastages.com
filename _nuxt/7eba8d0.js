(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{529:function(t,e,n){"use strict";n.r(e);var r={},o=n(21),component=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex mr:8>*"},[t.params.data.ticket_status<90?e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.params.editHandler(t.params)}}},[t._v(t._s(t.$t("common.edit")))]):t._e(),t._v(" "),t.params.data.ticket_status<90?e("Dropdown",{attrs:{type:"secondary",text:t.$t("admin.attendees.buttons.mail")}},[e("Button",{attrs:{type:"secondary"},on:{click:function(e){return t.params.resendSingleTicketMailHandler(t.params)}}},[t._v(t._s(t.$t("admin.tickets.buttons.resendSingleTicketMail")))])],1):t._e()],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Button:n(370).default,Dropdown:n(386).default})},569:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(20),n(68)),d=n(54),l=n.n(d),c=n(529),m=n(392),f=n.n(m),k=n(418),h=n.n(k),_=n(458),w=n.n(_),v={layout:"admin",components:{TicketButtonsCellRenderer:c.default},watch:{showAll:function(){this.getTickets()},showManualIntervention:function(t){t?this.gridAPI.getFilterInstance("ticket_status").setModel({filterType:"text",type:"equals",filter:this.$t("ticket_status.3")}):this.gridAPI.getFilterInstance("ticket_status").setModel({filterType:"text",type:"equals",filter:null}),this.gridAPI.onFilterChanged()}},data:function(){var t=this;return{COUNTRIES:f.a,SHIRT_SIZES:h.a,RECEIVE_METHODS:w.a,loading:!1,columnDefs:[{field:"buttons",headerName:" ",cellRenderer:"TicketButtonsCellRenderer",cellRendererParams:{resendSingleTicketMailHandler:this.resendSingleTicketMailHandler,editHandler:this.editHandler,deleteHandler:this.deleteHandler,restoreHandler:this.restoreHandler},width:384,sortable:!1,filter:!1},{field:"ticket_id",headerName:this.$t("admin.tickets.fields.ticket_id"),width:128,tooltipField:"ticket_id"},{field:"ticket_type",headerName:this.$t("admin.tickets.fields.ticket_type"),width:128,tooltipField:"ticket_type",valueGetter:function(e){return t.$t("admin.tickets.types."+e.data.ticket_type)},filterValueGetter:function(e){return t.$t("admin.tickets.types."+e.data.ticket_type)}},{field:"ticket_status",headerName:this.$t("admin.tickets.fields.ticket_status"),width:128,tooltipField:"ticket_status",valueGetter:function(e){return t.$t("ticket_status."+e.data.ticket_status)},filterValueGetter:function(e){return t.$t("ticket_status."+e.data.ticket_status)}},{field:"ticket_token",headerName:this.$t("admin.tickets.fields.ticket_token"),width:128,tooltipField:"ticket_token"},{field:"ticket_order_id",headerName:this.$t("admin.tickets.fields.ticket_order_id"),width:128,tooltipField:"ticket_order_id"},{field:"remarks",headerName:this.$t("admin.attendees.fields.remarks"),minWwidth:128,tooltipField:"remarks"},{field:"created_at",headerName:this.$t("admin.attendees.fields.created_at"),width:224,tooltipField:"created_at",valueGetter:function(t){return new Date(t.data.created_at).toLocaleString("zh-TW")},filterValueGetter:function(t){return new Date(t.data.created_at).toLocaleString("zh-TW")}},{field:"updated_at",headerName:this.$t("admin.attendees.fields.updated_at"),width:224,tooltipField:"updated_at",valueGetter:function(t){return new Date(t.data.updated_at).toLocaleString("zh-TW")},filterValueGetter:function(t){return new Date(t.data.updated_at).toLocaleString("zh-TW")}},{field:"created_by",headerName:this.$t("admin.attendees.fields.created_by"),width:128,tooltipField:"created_by"},{field:"updated_by",headerName:this.$t("admin.attendees.fields.updated_by"),width:128,tooltipField:"updated_by"}],defaultColumnDef:{sortable:!0,filter:!0,floatingFilter:!0,resizable:!0,floatingFilterComponentParams:{suppressFilterButton:!0}},gridAPI:null,gridColumnAPI:null,config:l.a.getConfig(),showAll:!1,showManualIntervention:!1,tickets:[],modal:{show:!1,mode:"edit",errorFields:{},form:{ticket_id:null,ticket_token:null,remarks:null}},deleteDialog:{show:!1,ticketID:null}}},mounted:function(){this.getTickets()},methods:{getTickets:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.get("/api/admin/tickets"+(t.showAll?"?all=yes":"")).then((function(e){t.tickets=e.data.tickets})).catch((function(t){o.a.showRequestError(t)}));case 3:t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},editHandler:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.modal.mode="edit",e.modal.form.ticket_id=t.data.ticket_id,e.modal.form.ticket_token=t.data.ticket_token,e.modal.form.remarks=t.data.remarks,e.$set(e.modal,"errorFields",{}),e.modal.show=!0;case 6:case"end":return n.stop()}}),n)})))()},editTicket:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.put("/api/admin/ticket/"+t.modal.form.ticket_id,t.modal.form).then((function(e){o.a.showSnackbar({message:t.$t("common.messages.updateSucceed"),colorType:"positive"}),t.modal.show=!1,t.getTickets()})).catch((function(e){e.response&&"422"==e.response.status&&t.$set(t.modal,"errorFields",e.response.data.errors),o.a.showRequestError(e)}));case 3:t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},deleteHandler:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.deleteDialog.ticketID=t.data.ticket_id,e.deleteDialog.show=!0;case 2:case"end":return n.stop()}}),n)})))()},deleteTicket:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$axios.delete("/api/admin/ticket/"+e.deleteDialog.ticketID).then((function(t){o.a.showSnackbar({message:e.$t("common.messages.deleteSucceed"),colorType:"positive"}),e.getTickets()})).catch((function(t){o.a.showRequestError(t)}));case 3:e.loading=!1,e.deleteDialog.show=!1;case 5:case"end":return t.stop()}}),t)})))()},resendSingleTicketMailHandler:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,e.$axios.post("/api/admin/ticket/"+t.data.ticket_id+"/mail").then((function(t){o.a.showSnackbar({message:e.$t("admin.attendees.messages.resend_paid_mail_succeed"),colorType:"positive"})})).catch((function(t){o.a.showRequestError(t)}));case 3:e.loading=!1;case 4:case"end":return n.stop()}}),n)})))()},restoreHandler:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,e.$axios.post("/api/admin/ticket/"+t.data.ticket_id+"/restore").then((function(t){o.a.showSnackbar({message:e.$t("admin.attendees.messages.restore_attendee_succeed"),colorType:"positive"}),e.getTickets()})).catch((function(t){o.a.showRequestError(t)}));case 3:e.loading=!1;case 4:case"end":return n.stop()}}),n)})))()},onGridReady:function(t){this.gridAPI=t.api,this.gridColumnAPI=t.columnApi}}},$=n(21),component=Object($.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-direction:column h:100%"},[e("Loading",{attrs:{value:t.loading}}),t._v(" "),e("div",{staticClass:"flex"},[e("Button",{staticClass:"width:100%",on:{click:function(e){return t.showAll=!t.showAll}}},[t._v(t._s(t.$t("admin.buttons.showAll"))+" :\n      "+t._s(t.$t("common."+(t.showAll?"yes":"no")))+"\n    ")]),t._v(" "),e("Button",{staticClass:"width:100%",on:{click:function(e){return t.showManualIntervention=!t.showManualIntervention}}},[t._v(t._s(t.$t("admin.buttons.showManualIntervention"))+" :\n      "+t._s(t.$t("common."+(t.showManualIntervention?"yes":"no")))+"\n    ")]),t._v(" "),e("Button",{staticClass:"width:100%",on:{click:function(e){t.gridAPI&&t.gridAPI.exportDataAsCsv()}}},[t._v(t._s(t.$t("admin.buttons.downloadCSV"))+"\n    ")])],1),t._v(" "),e("ag-grid-vue",{staticClass:"ag-theme-alpine",staticStyle:{"flex-grow":"1"},attrs:{columnDefs:t.columnDefs,defaultColDef:t.defaultColumnDef,rowData:t.tickets,enableCellTextSelection:!0,suppressRowTransform:!0,animateRows:"true"},on:{"grid-ready":t.onGridReady}}),t._v(" "),e("Modal",{attrs:{value:t.modal.show}},[e("div",{staticClass:"round border drop-shadow p:16|32 bg:white"},[e("h2",[t._v("\n        "+t._s(t.$t("common."+t.modal.mode))+t._s(t.$t("admin.attendees.itemName"))+"\n      ")]),t._v(" "),e("Field",{attrs:{field:t.$t("admin.tickets.fields.ticket_token"),error:t.modal.errorFields.ticket_token}},[e("InputText",{attrs:{error:t.modal.errorFields.ticket_token,maxlength:64},model:{value:t.modal.form.ticket_token,callback:function(e){t.$set(t.modal.form,"ticket_token",e)},expression:"modal.form.ticket_token"}})],1),t._v(" "),e("Field",{attrs:{field:t.$t("admin.attendees.fields.remarks"),error:t.modal.errorFields.remarks}},[e("InputText",{attrs:{error:t.modal.errorFields.remarks},model:{value:t.modal.form.remarks,callback:function(e){t.$set(t.modal.form,"remarks",e)},expression:"modal.form.remarks"}})],1),t._v(" "),e("div",{staticClass:"flex"},[e("Button",{staticClass:"mr:8",attrs:{type:"negative"},on:{click:function(e){return t.modal.show=!1}}},[t._v(t._s(t.$t("common.cancel")))]),t._v(" "),e("Button",{on:{click:t.editTicket}},[t._v(t._s(t.$t("common.submit")))])],1)],1)]),t._v(" "),e("Dialog",{attrs:{value:t.deleteDialog.show,yesText:t.$t("common.delete"),yesType:"negative",noText:t.$t("common.cancel"),noType:"secondary",title:t.$t("common.messages.confirmDeleteTitle"),description:t.$t("common.messages.confirmDeleteDescription")},on:{yes:t.deleteTicket,no:function(e){return t.deleteDialog.show=!1}}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Loading:n(136).default,Button:n(370).default,InputText:n(372).default,Field:n(374).default,Modal:n(399).default,Dialog:n(405).default})}}]);